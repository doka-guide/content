В JavaScript функция — это объект, у которого есть метод [`toString()`](/js/object-tostring/), возвращающий исходный код в виде строки. Это позволяет нам проанализировать текст функции и извлечь закомментированный код.

Решение можно разбить на несколько шагов:

**1. Получение текстового представления функции**

Сначала получаем код функции в виде строкового значения, используя метод `toString()`. Это даст нам доступ ко всему телу функции, включая комментарии.

```js
const fnText = fn.toString();
```

**2. Удаление символов комментариев**

Используем регулярное выражение для удаления символов комментария (`//`) из всех строк, где они встречаются. Это превращает закомментированный код в обычный исполняемый код, не меняя его содержимого.

```js
const uncommentedFnText = fnText.replace(/\/\/\s?/g, '');
```

**3. Извлечение параметров функции**

Для корректной работы с функцией нам важно сохранить все её параметры. Извлекаем их из исходного кода функции.

```js
const params = fnText.slice(fnText.indexOf('(') + 1, fnText.indexOf(')')).split(',').map(p => p.trim());
```

**4. Создание новой функции**

Создаём новую функцию, передавая параметры и тело с раскомментированным кодом в конструктор `new Function()`.

```js
return new Function(...params, `${uncommentedFnText.substring(uncommentedFnText.indexOf('{'))}`);
```

Теперь соберём всё вместе. Вот полное решение:

```js
function createFn(fn) {
  const fnText = fn.toString();
  const params = fnText.slice(fnText.indexOf('(') + 1, fnText.indexOf(')')).split(',').map(p => p.trim());
  const uncommentedFnText = fnText.replace(/\/\/\s?/g, '');

  return new Function(...params, `${uncommentedFnText.substring(uncommentedFnText.indexOf('{'))}`);
}
```

Что важно помнить при использовании этого решения:

- Работает только с однострочными комментариями — многострочные `/* */` останутся нетронутыми;
- При конфликтующих операциях (например, две переменные с одним именем) код может выдать ошибку.
