<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Прогресс-бар для статьи — Throttle на примере изменения страницы при прокрутке — Дока</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400&display=swap">
  <style>
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      padding: 60px 0 50px;
      background-color: #18191C;
      color: #FFFFFF;
      font-size: 16px;
      font-family: "Roboto", sans-serif;
    }

    main, header {
      width: 65%;
      min-width: 550px;
      max-width: 850px;
      margin: auto;
    }

    main {
      padding: 55px 40px;
      background-color: #FFFFFF;
      color: #665610;
    }

    header {
      position: fixed;
      top: 0;
      left: 0px;
      right: 0px;
      padding: 25px 40px;
      background-color: #18191C;
      font-size: 0;
    }

    footer {
      border-top: 1px solid currentColor;
      margin-top: 30px;
      padding: 10px 0;
      font-size: 14px;
      font-style: italic;
      font-weight: 300;
    }

    h1 {
      margin-bottom: 17px;
      font-size: 26px;
      font-weight: 500;
    }

    p {
      margin: 7px 0;
      line-height: 1.4;
    }

    progress {
      width: 100%;
      height: 7px;
      border: none;
      background-color: #665610;
    }

    progress::-moz-progress-bar {
      background-color: #FFD829;
    }

    progress::-webkit-progress-bar {
      background-color: #665610;
    }

    progress::-webkit-progress-value {
      background-color: #FFD829;
    }
  </style>
</head>
<body>
  <header>
    <progress value="0" max="100">
  </header>
  <main>
    <p>Голодная волчиха встала, чтобы идти на охоту. Её волчата, все трое, крепко спали, сбившись в кучу, и грели друг друга. Она облизала их и пошла.</p>
    <p>Был уже весенний месяц март, но по ночам деревья трещали от холода, как в декабре, и едва высунешь язык, как его начинало сильно щипать. Волчиха была слабого здоровья, мнительная; она вздрагивала от малейшего шума и все думала о том, как бы дома без неё кто не обидел волчат. Запах человеческих и лошадиных следов, пни, сложенные дрова и тёмная унавоженная дорога пугали её; ей казалось, будто за деревьями в потёмках стоят люди и где-то за лесом воют собаки.</p>
    <p>Она была уже не молода и чутье у неё ослабело, так что, случалось, лисий след она принимала за собачий и иногда даже, обманутая чутьём, сбивалась с дороги, чего с нею никогда не бывало в молодости. По слабости здоровья она уже не охотилась на телят и крупных баранов, как прежде, и уже далеко обходила лошадей с жеребятами, а питалась одною падалью; свежее мясо ей приходилось кушать очень редко, только весной, когда она, набредя на зайчиху, отнимала у неё детей или забиралась к мужикам в хлев, где были ягнята.</p>
    <p>В верстах четырёх от её логовища, у почтовой дороги, стояло зимовье. Тут жил сторож Игнат, старик лет семидесяти, который все кашлял и разговаривал сам с собой; обыкновенно ночью он спал, а днём бродил по лесу с ружьём-одностволкой и посвистывал на зайцев. Должно быть, раньше он служил в механиках, потому что каждый раз, прежде чем остановиться, кричал себе: «Стоп, машина!» и прежде чем пойти дальше: «Полный ход!» При нем находилась громадная чёрная собака неизвестной породы, по имени Арапка. Когда она забегала далеко вперёд, то он кричал ей: «Задний ход!» Иногда он пел и при этом сильно шатался и часто падал (волчиха думала, что это от ветра) и кричал: «Сошёл с рельсов!»</p>
    <p>Волчиха помнила, что летом и осенью около зимовья паслись баран и две ярки, и когда она не так давно пробегала мимо, то ей послышалось, будто в хлеву блеяли. И теперь, подходя к зимовью, она соображала, что уже март и, судя по времени, в хлеву должны быть ягнята непременно. Её мучил голод, она думала о том, с какою жадностью она будет есть ягнёнка, и от таких мыслей зубы у неё щёлкали и глаза светились в потёмках, как два огонька.</p>
    <p>Изба Игната, его сарай, хлев и колодец были окружены высокими сугробами. Было тихо. Арапка, должно быть, спала под сараем.</p>
    <p>По сугробу волчиха взобралась на хлев и стала разгребать лапами и мордой соломенную крышу. Солома была гнилая и рыхлая, так что волчиха едва не провалилась; на неё вдруг прямо в морду пахнуло тёплым паром и запахом навоза и овечьего молока. Внизу, почувствовав холод, нежно заблеял ягнёнок. Прыгнув в дыру, волчиха упала передними лапами и грудью на что-то мягкое и тёплое, должно быть, на барана, и в это время в хлеву что-то вдруг завизжало, залаяло и залилось тонким, подвывающим голоском, овцы шарахнулись к стенке, и волчиха, испугавшись, схватила, что первое попалось в зубы, и бросилась вон...</p>
    <p>Она бежала, напрягая силы, а в это время Арапка, уже почуявшая волка, неистово выла, кудахтали в зимовье потревоженные куры, и Игнат, выйдя на крыльцо, кричал:</p>
    <p>— Полный ход! Пошёл к свистку!</p>
    <p>И свистел, как машина, и потом — го-го-го-го!.. И весь этот шум повторяло лесное эхо.</p>
    <p>Когда мало-помалу всё это затихло, волчиха успокоилась немного и стала замечать, что её добыча, которую она держала в зубах и волокла по снегу, была тяжелее и как будто твёрже, чем обыкновенно бывают в эту пору ягнята; и пахло как будто иначе, и слышались какие-то странные звуки... Волчиха остановилась и положила свою ношу на снег, чтобы отдохнуть и начать есть, и вдруг отскочила с отвращением. Это был не ягнёнок, а щенок, чёрный, с большой головой и на высоких ногах, крупной породы, с таким же белым пятном во весь лоб, как у Арапки. Судя по манерам, это был невежа, простой дворняжка. Он облизал свою помятую, раненую спину и, как ни в чем не бывало, замахал хвостом и залаял на волчиху. Она зарычала, как собака, и побежала от него. Он за ней. Она оглянулась и щёлкнула зубами; он остановился в недоумении и, вероятно, решив, что это она играет с ним, протянул морду по направлению к зимовью и залился звонким радостным лаем, как бы приглашая мать свою Арапку поиграть с ним и с волчихой.</p>
    <p>Уже светало, и когда волчиха пробиралась к себе густым осинником, то было видно отчётливо каждую осинку, и уже просыпались тетерева и часто вспархивали красивые петухи, обеспокоенные неосторожными прыжками и лаем щенка.</p>
    <p>«Зачем он бежит за мной? — думала волчиха с досадой. — Должно быть, он хочет, чтобы я его съела».</p>
    <p>Жила она с волчатами в неглубокой яме; года три назад во время сильной бури вывернуло с корнем высокую старую сосну, отчего и образовалась эта яма. Теперь на дне её были старые листья и мох, тут же валялись кости и бычьи рога, которыми играли волчата. Они уже проснулись и все трое, очень похожие друг на друга, стояли рядом на краю своей ямы и, глядя на возвращавшуюся мать, помахивали хвостами. Увидев их, щенок остановился поодаль и долго смотрел на них; заметив, что они тоже внимательно смотрят на него, он стал лаять на них сердито, как на чужих.</p>
    <p>Уже рассвело и взошло солнце, засверкал кругом снег, а он все стоял поодаль и лаял. Волчата сосали свою мать, пихая её лапами в тощий живот, а она в это время грызла лошадиную кость, белую и сухую; её мучил голод, голова разболелась от собачьего лая, и хотелось ей броситься на непрошенного гостя и разорвать его.</p>
    <p>Наконец щенок утомился и охрип; видя, что его не боятся и даже не обращают на него внимания, он стал несмело, то приседая, то подскакивая, подходить к волчатам. Теперь, при дневном свете, легко уже было рассмотреть его... Белый лоб у него был большой, а на лбу бугор, какой бывает у очень глупых собак; глаза были маленькие, голубые, тусклые, а выражение всей морды чрезвычайно глупое. Подойдя к волчатам, он протянул вперёд широкие лапы, положил на них морду и начал:</p>
    <p>— Мня, мня... нга-нга-нга!..</p><!-- yaspeller ignore -->
    <p>Волчата ничего не поняли, но замахали хвостами. Тогда щенок ударил лапой одного волчонка по большой голове. Волчонок тоже ударил его лапой по голове. Щенок стал к нему боком и посмотрел на него искоса, помахивая хвостом, потом вдруг рванулся с места и сделал несколько кругов по насту. Волчата погнались за ним, он упал на спину и задрал вверх ноги, а они втроём напали на него и, визжа от восторга, стали кусать его, но не больно, а в шутку. Вороны сидели на высокой сосне и смотрели сверху на их борьбу, и очень беспокоились. Стало шумно и весело. Солнце припекало уже по-весеннему; и петухи, то и дело перелетавшие через сосну, поваленную бурей, при блеске солнца казались изумрудными.</p>
    <p>Обыкновенно волчихи приучают своих детей к охоте, давая им поиграть добычей; и теперь, глядя, как волчата гонялись по насту за щенком и боролись с ним, волчиха думала:</p>
    <p>«Пускай приучаются».</p>
    <p>Наигравшись, волчата пошли в яму и легли спать. Щенок повыл немного с голоду, потом также растянулся на солнышке. А проснувшись, опять стали играть.</p>
    <p>Весь день и вечером волчиха вспоминала, как прошлою ночью в хлеву блеял ягнёнок и как пахло овечьим молоком, и от аппетита она все щёлкала зубами и не переставала грызть с жадностью старую кость, воображая себе, что это ягнёнок. Волчата сосали, а щенок, который хотел есть, бегал кругом и обнюхивал снег.</p>
    <p>«Съем-ка его...» — решила волчиха.</p>
    <p>Она подошла к нему, а он лизнул её в морду и заскулил, думая, что она хочет играть с ним. В былое время она едала собак, но от щенка сильно пахло псиной, и, по слабости здоровья, она уже не терпела этого запаха; ей стало противно, и она отошла прочь...</p>
    <p>К ночи похолодело. Щенок соскучился и ушёл домой.</p>
    <p>Когда волчата крепко уснули, волчиха опять отправилась на охоту. Как и в прошлую ночь, она тревожилась малейшего шума, и её пугали пни, дрова, тёмные, одиноко стоящие кусты можжевельника, издали похожие на людей. Она бежала в стороне от дороги, по насту. Вдруг далеко впереди на дороге замелькало что-то тёмное... Она напрягла зрение и слух: в самом деле, что-то шло впереди, и даже слышны были мерные шаги. Не барсук ли? Она осторожно, чуть дыша, забирая все в сторону, обогнала тёмное пятно, оглянулась на него и узнала. Это, не спеша, шагом, возвращался к себе в зимовье щенок с белым лбом.</p>
    <p>«Как бы он опять мне не помешал», — подумала волчиха и быстро побежала вперёд.</p>
    <p>Но зимовье было уже близко. Она опять взобралась на хлев по сугробу. Вчерашняя дыра была уже заделана яровой соломой, и по крыше протянулись две новые слеги. Волчиха стала быстро работать ногами и мордой, оглядываясь, не идёт ли щенок, но едва пахнуло на неё тёплым паром и запахом навоза, как сзади послышался радостный, заливчатый лай. Это вернулся щенок. Он прыгнул к волчихе на крышу, потом в дыру и, почувствовав себя дома, в тепле, узнав своих овец, залаял ещё громче... Арапка проснулась под сараем и, почуяв волка, завыла, закудахтали куры, и когда на крыльце показался Игнат со своей одностволкой, то перепуганная волчиха была уже далеко от зимовья.</p>
    <p>— Фюйть! — засвистел Игнат. — Фюйть! Гони на всех парах!</p>
    <p>Он спустил курок — ружье дало осечку; он спустил ещё раз — опять осечка; он спустил в третий раз — и громадный огненный сноп вылетел из ствола и раздалось оглушительное <!-- yaspeller ignore:start -->«бу! бу!»<!-- yaspeller ignore:end --> Ему сильно отдало в плечо; и, взявши в одну руку ружье, а в другую топор, он пошёл посмотреть, отчего шум...</p>
    <p>Немного погодя он вернулся в избу.</p>
    <p>— Что там? — спросил хриплым голосом странник, ночевавший у него в эту ночь и разбуженный шумом.</p>
    <p>— Ничего... — ответил Игнат. — Пустое дело. Повадился наш Белолобый с овцами спать, в тёпле. Только нет того понятия, чтобы в дверь, а норовит все как бы в крышу. Намедни ночью разобрал крышу и гулять ушёл, подлец, а теперь вернулся и опять разворошил крышу.</p>
    <p>— Глупый.</p>
    <p>— Да, пружина в мозгу лопнула. Смерть не люблю глупых! — вздохнул Игнат, полезай на печь. — Ну, божий человек, рано ещё вставать, давай спать полным ходом...</p>
    <p>А утром он подозвал к себе Белолобого, больно оттрепал его за уши и потом, наказывая его хворостиной, все приговаривал:</p>
    <p>— Ходи в дверь! Ходи в дверь! Ходи в дверь!</p>
    <footer>Белолобый, Чехов А.П., 1895</footer>
  </main>
  <script>
    const progress = document.querySelector('progress');

    function recalculateProgress() {
      const viewportHeight = window.innerHeight;
      const pageHeight = document.body.offsetHeight;
      const currentPosition = window.scrollY;

      const availableHeight = pageHeight - viewportHeight;
      const percent = (currentPosition / availableHeight) * 100;
      progress.value = percent;
      console.log(percent)
    }

    function throttle(callee, timeout) {
      let timer = null;

      return function perform(...args) {
        if (timer) return;

        timer = setTimeout(() => {
          callee(...args);

          clearTimeout(timer);
          timer = null;
        }, timeout);
      }
    }

    const optimizedHandler = throttle(recalculateProgress, 50);
    window.addEventListener('scroll', optimizedHandler);
    window.addEventListener('resize', optimizedHandler);

  </script>
</body>
</html>
