<h2>Кратко</h2>
<p>Вендорные префиксы — это приставки перед свойствами, селекторами, функциями или другими сущностями в CSS, позволяющие браузерам внедрять экспериментальные фичи до того, как они полностью стандартизированы и готовы для использования. Когда префикс отбрасывается — это знак, что всё готово.</p>
<h2>Кто такие вендоры?</h2>
<p>Чтобы понять, что такое вендорные префиксы и зачем они нужны, надо немного разобраться с тем, как и кто разрабатывает CSS.</p>
<p>CSS — это одна из трёх основных мощных технологий, на которых строится веб. Его используют в своей работе тысячи разработчиков. А результат — стили сайта — видят миллионы пользователей.</p>
<p>Чтобы CSS во всём мире был единым, над его развитием работает так называемая <a href="https://www.w3.org/wiki/CSSWG"><em>Рабочая группа CSS</em></a> (CSS Working Group), или коротко CSSWG. Они собирают потребности разработчиков сайтов и описывают возможности CSS в новых модулях. Получившийся документ называется <em>спецификацией</em>. В ней содержится описание того, как новое свойство должно работать.</p>
<p>Дальше наступает этап внедрения в браузеры. Каждый браузер разрабатывает отдельная компания, отдельные команды разработки. Когда в черновиках спецификации появляется новая CSS-фича, разработчики браузера начинают её реализовывать. Поскольку в спецификации не всегда описаны конкретные технические решения (черновик на то и черновик, что может меняться), то каждая команда разработки может делать это чуть иначе и принципы работы фичи вполне могут меняться со временем. До момента, пока не стабилизируется спецификация или пока не будут написаны все тесты, фича может работать в тестовом режиме, с вендорным префиксом.</p>
<p>Каждый браузер — это отдельный <em>вендор</em> (от англ. vendor — продавец) услуг просмотра сайтов, интернета. Отсюда и слово «вендорный». Буквально это означает, что существуют некие отдельные префиксы — они же приставки — которые работают в конкретном браузере — вендоре.</p>
<h2>Префиксы</h2>
<p>Основные браузеры используют следующие префиксы:</p>
<ul>
<li><code>-webkit-</code> — Safari, Chrome, Opera 15+ и другие браузеры на основе движка WebKit или Blink.</li>
<li><code>-moz-</code> — Firefox и браузеры на движке Gecko.</li>
<li><code>-o-</code> — Opera 12 и раньше, на движке Presto.</li>
<li><code>-ms-</code> — Internet Explorer и старый Microsoft Edge 12–18.</li>
</ul>
<h2>Где нужны префиксы?</h2>
<p>В CSS существует много разных сущностей: селекторы и псевдоэлементы, свойства и их значения, функции, директивы. В процессе внедрения любой новой фичи используются вендорные префиксы.</p>
<h3>Директивы</h3>
<p>Самый частый случай, когда вам может пригодится вендорный префикс для директивы — <a href="/css/keyframes/"><code>@keyframes</code></a>:</p>
<pre><code class="language-css">@-webkit-keyframes animation {
  0% { left: 0; }
  100% { left: 100%; }
}

@keyframes animation {
  0% { left: 0; }
  100% { left: 100%; }
}
</code></pre>
<p>Написать директивы <code>@-webkit-keyframes</code> и <code>@keyframes</code> через запятую, чтобы не дублировать их содержимое, не получится.</p>
<h3>Псевдоклассы</h3>
<p>В последнее время в CSS появляется много новых очень мощных псевдоклассов. Например, стилизовать плейсхолдер в поле ввода можно при помощи такого кода:</p>
<pre><code class="language-css">input::-webkit-input-placeholder {
  color: #BADA55;
}

input:-moz-placeholder {
  color: #BADA55;
}

input::-moz-placeholder {
  color: #BADA55;
}

input:-ms-input-placeholder {
  color: #BADA55;
}

input::-ms-input-placeholder {
  color: #BADA55;
}

input::placeholder {
  color: #BADA55;
}
</code></pre>
<p>Как и в случае с директивами, префиксы в псевдоэлементах тоже приводят к дублированию кода: если перечислить всё через запятую, браузеры вас не поймут.</p>
<h3>Значения свойств</h3>
<p>Бывает и так, что свойство старое, а вот значение для него новое, экспериментальное. В данный момент таким новым значением является функция <a href="/css/image-set/"><code>image-set()</code></a> для свойства <a href="/css/background-image/"><code>background-image</code></a>:</p>
<pre><code class="language-css">div {
  background-image: url(&quot;image.png&quot;);
  background-image: -webkit-image-set(url(&quot;image.png&quot;) 1x, url(&quot;image-2x.png&quot;) 2x);
  background-image: image-set(&quot;image.png&quot; 1x, &quot;image-2x.png&quot; 2x);
}
</code></pre>
<p>Сначала браузер прочитает свойство <code>background-image</code> со значением <code>url()</code>, которое он точно понимает. Потом увидит такое же свойство с другим значением, и если он его поймёт, то забудет первое свойство и применит второе. Это называется <em>фолбэк</em>.</p>
<p>Но браузер на этом не остановится и пойдёт дальше: если он поддерживает значение без префикса, то он предпочтёт его — ведь оно последнее. Поэтому порядок следования свойств с префиксами в значениях тоже важен: сначала идут значения с префиксами, потом — без, чтобы браузеры выбрали последний, максимально современный вариант.</p>
<h3>Селекторы</h3>
<p>Случается так, что в процессе внедрения фича меняется. Изначально планировалось, что функция выбора нескольких селекторов будет называться <code>:any()</code>, потом <code>:match()</code>, а в итоге пришли к <a href="/css/is/"><code>:is()</code></a>. Чтобы селектор сработал везде, даже в старых браузерах, где функция называлась иначе, нужна будет такая запись:</p>
<pre><code class="language-css">:-moz-any(header, footer) a:hover {
  color: red;
}

:-webkit-any(header, footer) a:hover {
  color: red;
}

:matches(header, footer) a:hover {
  color: red;
}

:is(header, footer) a:hover {
  color: red;
}
</code></pre>
<p>В примере выше мы задаём красный цвет для ссылок при наведении курсора при условии, что эти ссылки находятся внутри <a href="/html/header/"><code>&lt;header&gt;</code></a> или <a href="/html/footer/"><code>&lt;footer&gt;</code></a>.</p>
<h2>Как всё запомнить?</h2>
<p>Скорее всего, вы сейчас думаете, а как же запомнить, где какие префиксы нужно писать, и для каких свойств они действительно нужны, а какие поддерживаются и без них.</p>
<p>Самый простой способ проверить поддержку свойства — найти его на сайте <a href="https://caniuse.com">Can I use</a>. Там, в том числе, написано, какие префиксы для каких браузеров нужны.</p>
<p>Но чаще всего разработчики не пишут префиксы руками, а используют инструменты автоматизации. Самым популярным из них на сегодня является <a href="https://github.com/postcss/autoprefixer">Автопрефиксер</a>. Вы можете <a href="https://autoprefixer.github.io/ru/">попробовать его онлайн</a>: вставляете ваш CSS, указываете, какие браузеры должны поддерживаться, и получаете код с проставленными префиксами там, где это нужно.</p>
<h2>Порядок важен</h2>
<p>Очень важно указывать сущности (свойства, селекторы, директивы и так далее) с вендорными префиксами выше, чем без префиксов:</p>
<pre><code class="language-css">div {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
</code></pre>
<p>Это нужно для того, чтобы браузер использовал самую последнюю стабильную реализацию. Если браузер уже поддерживает фичу без префиксов, то применится последнее из перечисленных. А если нет, то сработает подходящая запись из кода выше.</p>
<p><img src="images/vendor-prefixe-example.png" alt="Скриншот инструментов разработчика Chrome, на котором видно, что применяется свойство user-select без вендорных префиксов"></p>
