<h2>Кратко</h2>
<p>Директива, которая помогает применять разные стили для разных параметров экрана — ширины, высоты, ориентации и даже типа устройства.</p>
<h2>Пример</h2>
<p>Сделаем элемент с классом <code>block</code> флекс-контейнером на экране шириной 900 пикселей или больше:</p>
<pre><code class="language-css">@media (min-width: 900px) {
  .block {
    display: flex;
  }
}
</code></pre>
<h2>Как это понять</h2>
<p>При вёрстке адаптивных сайтов часто нужно чтобы какой-то набор стилей применился только при соблюдении определённых параметров. Например, текст должен стать зелёным только при горизонтальной ориентации смартфона. Или блок занял всю ширину родителя, если ширина экрана больше или равна 1500 пикселям. Для подобных действий и существуют медиавыражения. Они помогают адаптировать вёрстку под разные экраны и устройства и при этом не писать лишний код.</p>
<h2>Как пишется</h2>
<p>В общем виде синтаксис выглядит так:</p>
<pre><code class="language-css">@media [тип устройства] [характеристика устройства] {
  [css-правила]
}
</code></pre>
<p>Например:</p>
<pre><code class="language-css">@media print and (orientation: landscape) {
  .block {
    font-size: 25pt;
  }
}
</code></pre>
<p>Здесь тип устройства — <code>print</code> (принтер), а характеристика устройства — <code>orientation: landscape</code> (альбомная ориентация). То есть при альбомной ориентации устройства (листа) размер шрифта у блока будет 25 пунктов.</p>
<p>Есть четыре типа устройств, которые мы можем указать:</p>
<ul>
<li><code>all</code> — медиавыражение применится ко всем устройствам. Если не прописать никакой тип, то по умолчанию применится этот;</li>
<li><code>print</code> — стили внутри такого медиавыражения применятся при печати на принтерах или экспорте в PDF, в том числе в режиме предпросмотра документа;</li>
<li><code>screen</code> — для устройств с экранами;</li>
<li><code>speech</code> — для синтезаторов речи (пока не поддерживается ни одним браузером).</li>
</ul>
<p>В большинстве случаев, когда вы пишете стили только для экрана, указывать <code>screen</code> или <code>all</code> смысла нет. Реальное практическое использование есть только у типа <code>print</code>.</p>
<p>Возможные характеристики устройства можно разделить на несколько категорий:</p>
<details>
  <summary>Характеристики страницы и окна браузера</summary>
<ul>
<li><code>aspect-ratio</code> — соотношение между шириной и высотой окна;</li>
<li><code>height</code> — высота окна браузера;</li>
<li><code>max-aspect-ratio</code> — максимальное соотношение между шириной и высотой окна;</li>
<li><code>max-width</code> — максимальная ширина окна браузера;</li>
<li><code>min-aspect-ratio</code> — минимальное соотношение между шириной и высотой окна;</li>
<li><code>min-height</code> — минимальная высота окна браузера;</li>
<li><code>min-width</code> — минимальная ширина окна браузера;</li>
<li><code>orientation</code> — ориентация устройства: <code>landscape</code> (альбомная, горизонтальная) или <code>portrait</code> (портретная, вертикальная);</li>
<li><code>overflow-block</code> — проверка, как устройство вывода обрабатывает содержимое, которое выходит за пределы области просмотра по оси блока;</li>
<li><code>overflow-inline</code> — проверка, можно ли прокручивать содержимое, выходящее за пределы области просмотра по встроенной оси;</li>
<li><code>width</code> — ширина окна браузера.</li>
</ul>
</details>
<details>
  <summary>Качество отображения</summary>
<ul>
<li><code>environment-blending</code> — метод для определения внешнего окружения устройства, такого как тусклое или слишком яркое освещение;</li>
<li><code>display-mode</code> — проверка режима браузера, используется в PWA: <code>fullscreen</code> (полноэкранный режим без интерфейса браузера), <code>standalone</code> (как нативное приложение), <code>minimal-ui</code> (минимальный интерфейс браузера) и <code>browser</code> (обычное окно браузера);</li>
<li><code>grid</code> — проверка, является ли экран растровым (все современные экраны) или сеточным (как старые телефоны или текстовые терминалы);</li>
<li><code>max-resolution</code> — максимальное разрешение устройства в dpi или dpcm;</li>
<li><code>min-resolution</code> — минимальное разрешение устройства в dpi или dpcm;</li>
<li><code>resolution</code> — разрешение устройства в dpi или dpcm;</li>
<li><code>scan</code> — процесс сканирования устройства вывода;</li>
<li><code>update</code> — скорость обновления экрана: <code>none</code> (не обновляется), <code>slow</code> (медленно), <code>fast</code> (быстро).</li>
</ul>
</details>
<details>
  <summary>Цвет</summary>
<ul>
<li><code>color</code> — количество бит на цвет на устройстве вывода;</li>
<li><code>color-gamut</code> — примерный диапазон цветов, поддерживаемый браузером и устройством вывода;</li>
<li><code>color-index</code> — количество цветов, которое может отображаться устройством;</li>
<li><code>dynamic-range</code> — комбинация уровня яркости, глубины цвета и контрастного соотношения для видео в браузере или устройстве вывода;</li>
<li><code>inverted-colors</code> — проверка, инвертируются ли цвета браузером или ОС;</li>
<li><code>max-color</code> — максимальное количество бит на цвет на устройстве вывода;</li>
<li><code>max-color-index</code> — максимальное количество цветов, которое может отображаться устройством;</li>
<li><code>max-monochrome</code> — максимальное количество бит на цвет на монохромном устройстве вывода;</li>
<li><code>min-color</code> — минимальное количество бит на цвет на устройстве вывода;</li>
<li><code>min-color-index</code> — минимальное количество цветов, которое может отображаться устройством;</li>
<li><code>min-monochrome</code> — минимальное количество бит на цвет на монохромном устройстве вывода;</li>
<li><code>monochrome</code> — количество бит на цвет на монохромном устройстве вывода.</li>
</ul>
</details>
<details>
  <summary>Взаимодействие</summary>
<ul>
<li><code>any-hover</code> — проверка, позволяет ли любое из устройств ввода наводить указатель на элементы;</li>
<li><code>any-pointer</code> — проверка, является ли любое из устройств ввода указателем, и насколько оно точное;</li>
<li><code>hover</code> — проверка, позволяет ли основное устройство наводить указатель на элементы;</li>
<li><code>pointer</code> — проверка, является ли основное устройство ввода указателем, и насколько оно точное.</li>
</ul>
</details>
<details>
  <summary>Характеристики с префиксом <code>video-</code></summary>
<ul>
<li><code>video-color-gamut</code> — примерный диапазон цветов, поддерживаемый для видео в браузере и устройстве вывода;</li>
<li><code>video-dynamic-range</code> — комбинация уровня яркости, глубины цвета и контрастного соотношения для видео в браузере или устройстве вывода;</li>
<li><code>video-height</code> — высота видео на выбранном дисплее (ведётся обсуждение);</li>
<li><code>video-resolution</code> — разрешение видео на выбранном дисплее (ведётся обсуждение);</li>
<li><code>video-width</code> — ширина видео на выбранном дисплее (ведётся обсуждение).</li>
</ul>
</details>
<details>
  <summary>Скрипты</summary>
<ul>
<li><code>scripting</code> — проверка, включены ли скрипты;</li>
</ul>
</details>
<details>
  <summary>Пользовательские настройки</summary>
<ul>
<li><code>forced-colors</code> — проверка, запрещает ли браузер цвета, доступные для использования;</li>
<li><code>prefers-color-scheme</code> — определяет, какую тему предпочитает пользователь — светлую или тёмную;</li>
<li><code>prefers-contrast</code> — определяет, установлены ли настройки для увеличения или уменьшения контраста между цветами;</li>
<li><code>prefers-reduced-data</code> — определяет, предпочитает ли пользователь загружать меньше данных на странице;</li>
<li><code>prefers-reduced-motion</code> — определяет, отключены ли анимации в системных настройках пользователя;</li>
<li><code>prefers-reduced-transparency</code> — определяет, отключена ли прозрачность в системных настройках пользователя.</li>
</ul>
</details>
<details>
  <summary>Устаревшие</summary>
<ul>
<li><code>device-aspect-ratio</code> — соотношение между шириной и высотой устройства вывода;</li>
<li><code>device-height</code> — высота дисплея устройства;</li>
<li><code>device-width</code> — ширина дисплея устройства.</li>
</ul>
</details>
<p>В медиавыражении может быть перечислено несколько условий через запятую. В таком случае стили применятся для любого из указанных условий. Например:</p>
<pre><code class="language-css">@media (orientation: landscape), (max-width: 960px) {
  .text {
    color: tomato;
  }
}
</code></pre>
<p>Такой код применится на всех устройствах с альбомной ориентацией экрана или на всех устройствах с шириной экрана менее 960 пикселей.</p>
<p>Часто в медиавыражениях может использоваться ключевое слово <code>and</code>, реже встречаются ключевые слова <code>not</code> и <code>only</code>.</p>
<p>Если мы пишем и тип устройства, и указываем характеристики, то после типа обязательно пишется <code>and</code>.</p>
<pre><code class="language-css">@media print and (min-width: 320px) {
  .link {
    text-decoration: underline;
  }
}
</code></pre>
<p>Также <code>and</code> пишется между характеристиками.</p>
<pre><code class="language-css">@media (min-width: 320px) and (max-width: 640px) {
  .link {
    text-decoration: underline;
  }
}
</code></pre>
<p>Ключевое слово <code>not</code> используется для отрицания выражения. Оно имеет низкий приоритет и применяется в последнюю очередь. Например:</p>
<pre><code class="language-css">@media not screen and (min-width: 380px) {
  .block {
    display: flex;
  }
}
</code></pre>
<p>Здесь сначала вычислится выражение «для всех экранов с минимальной шириной 380 пикселей», а потом оно инвертируется — «для всех устройств, кроме устройств с экранами с минимальной шириной 380 пикселей». То есть будет читаться браузером как:</p>
<pre><code class="language-css">@media not (screen and (min-width: 380px)) {
  .block {
    display: flex;
  }
}
</code></pre>
<p>При использовании <code>not</code> в медиавыражениях с запятой инвертируется только та часть выражения, где указан <code>not</code>. Например:</p>
<pre><code class="language-css">@media not screen and (height: 500px), print and (height: 700px) {
  .text {
    color: tomato;
  }
}
</code></pre>
<p>Чтобы лучше понять, как выполнится этот пример, можно добавить дополнительные группирующие скобки:</p>
<pre><code class="language-css">@media (not (screen and (height: 500px))), print and (height: 700px) {
  .text {
    color: tomato;
  }
}
</code></pre>
<p>Поскольку запятая в медиавыражении означает лишь перечисление, то <code>not</code> в первой части выражения не будет распространяться на вторую, и инвертируется только часть «для всех экранов с высотой окна браузера 500 пикселей».</p>
<p>Ключевое слово <code>only</code> иногда встречается перед указанием типа устройства — оно используется для того, чтобы старые браузеры, которые не поддерживают медиавыражения, не применяли указанные стили. Современные браузеры никак не реагируют на <code>only</code>.</p>
<pre><code class="language-css">@media only screen and (max-width: 600px) {
  body {
    background-color: cornflowerblue;
  }
}
</code></pre>
<h2>Подсказки</h2>
<p>💡 Для вёрстки от мобильных (mobile first) лучше использовать медиавыражения с <code>min-width</code> и располагать их в порядке увеличения ширины экрана; для вёрстки от десктопа (desktop first) — <code>max-width</code>, и располагать выражения в обратном порядке.</p>
