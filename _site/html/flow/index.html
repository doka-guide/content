<p>Поток — одно из важнейших базовых понятий в вёрстке. Это принцип организации элементов на странице при отсутствии стилей: если мы напишем HTML и не напишем CSS, то отображение в браузере будет предсказуемо благодаря тому, что мы абсолютно точно знаем, как браузер располагает элементы в потоке.</p>
<p>Даже если к странице не подключено никаких стилей, к каждому элементу всё равно будут применяться CSS-правила, «зашитые» в движке браузера. Благодаря этим правилам заголовок <code>&lt;h1&gt;</code> крупнее заголовка <code>&lt;h2&gt;</code>, а ссылки — синие и подчёркнутые. На основании этих правил <strong>условно</strong> все элементы на странице можно разделить на две категории: блочные (block) и строчные (inline). Например, <code>&lt;div&gt;</code> будет блочным, а <code>&lt;span&gt;</code> или <code>&lt;a&gt;</code> — строчным. Поменять стандартное поведение можно при помощи CSS-свойства <a href="/css/display/"><code>display</code></a>.</p>
<p>Если вообще не применять никаких стилей, браузер формирует из элементов <strong>нормальный поток</strong>. Поведение блочных элементов в нормальном потоке отличается от поведения строчных.</p>
<h2>Контекст форматирования</h2>
<p>Правила расположения строчных и блочных элементов в нормальном потоке называются <strong>контекстом форматирования</strong>. Блочные элементы участвуют в формировании <strong>блочного</strong> контекста форматирования. Строчные элементы формируют <strong>строчный</strong> контекст форматирования. Расположение элементов в контексте форматирования зависит от направления письма для конкретного языка. Например, тексты на европейских языках мы читаем и пишем слева направо сверху вниз. Это означает, что по умолчанию контекст форматирования располагает блочные элементы сверху вниз, а строчные — слева направо. Но, например, в случае с японским языком мы видим совершенно другую картину: блочные элементы будут располагаться слева направо, а строчные — сверху вниз.</p>
<p>Во всех примерах далее будет рассматриваться направление письма, характерное для европейских языков: слова — слева направо, блоки — сверху вниз. Но все те же объяснения можно применять и для другого направления письма.</p>
<h2>Блочные элементы в нормальном потоке</h2>
<p>Блочные элементы в нормальном потоке располагаются друг под другом, всегда занимая всю доступную ширину родителя. Высота блочного элемента по умолчанию равна высоте его содержимого. Три абзаца, идущие друг за другом в HTML, будут располагаться точно в таком же порядке и на странице.</p>
<iframe title="Блочные элементы в нормальном потоке" src="demos/normal/" height="550"></iframe>
<p>Даже если ширина блочного элемента явно задана и позволяет разместить справа ещё один такой элемент, поток всё равно продолжит выстраивать их друг под другом.</p>
<iframe title="Блочные элементы, ограниченные по ширине, в нормальном потоке" src="demos/normal-width/" height="570"></iframe>
<p>Можно воспринимать блочный элемент как поплавок, который стремится всплыть на странице как можно выше. И всплывает до тех пор, пока не встретит на пути другой элемент или границу родителя.</p>
<iframe title="Анимация блочных элементов в нормальном потоке" src="demos/normal-animated/" height="630"></iframe>
<h2>Строчные элементы в нормальном потоке</h2>
<p>Строчные элементы располагаются друг за другом, как слова в предложении. В зависимости от направления письма в конкретном языке элементы могут располагаться слева направо (например, в русском языке), справа налево (как, например, в иврите) и даже сверху вниз, как иероглифы в японском письме. Ширина и высота строчного элемента равна ширине и высоте содержимого. В отличие от блочного элемента, мы не можем управлять шириной и высотой строчного элемента через CSS. Несколько строчных элементов будут стремиться уместиться на одной строке, насколько хватает ширины родителя. Если ширины родителя не хватает, то лишний текст строчного элемента переносится на следующую строку.</p>
<iframe title="Строчные элементы в нормальном потоке" src="demos/inline/" height="240"></iframe>
<h2>Схлопывание и выпадение отступов</h2>
<p>В рамках блочного контекста форматирования вертикальные расстояния между блоками задаются CSS-свойством <a href="/css/margin/"><code>margin</code></a>. Если блоку задан нижний отступ, а следующему за ним — верхний, то можно ожидать, что итоговый отступ между блоками будет равен сумме этих двух отступов. Но в соответствии со спецификацией соприкасающиеся отступы «схлопываются». То есть как бы проваливаются один в другой. Итоговый отступ будет равен бо́льшему отступу из двух.</p>
<iframe title="Схлопывание отступов" src="demos/margin-collapse-siblings/" height="650"></iframe>
<p>Если первому дочернему элементу в блоке задан верхний отступ или последнему элементу — нижний, то эти отступы «выпадают» во внешний мир из своего родителя.</p>
<iframe title="Выпадение отступов" src="demos/margin-collapse-empty/" height="590"></iframe>
<p>Выпадение отступов из родителя можно предотвратить несколькими способами:</p>
<ul>
<li>Задать родителю вертикальный внутренний отступ <a href="/css/padding/"><code>padding-top</code></a> или <a href="/css/padding/"><code>padding-bottom</code></a> в зависимости от того, с какой стороны мы хотим предотвратить выпадение.</li>
<li>Задать родителю верхнюю или нижнюю <a href="/css/border/">рамку</a> по такой же логике. Рамка может быть прозрачной, главное, чтобы она была :)</li>
<li>Задать родителю свойство <a href="/css/overflow/"><code>overflow</code></a> со значением, отличным от <code>visible</code>.</li>
<li>Переопределить родителю свойство <a href="/css/display/"><code>display</code></a> на <code>flex</code> или <code>grid</code>.</li>
</ul>
<h2>Выход из потока</h2>
<p>Ранее мы выяснили, что все элементы по умолчанию находятся в нормальном потоке. Но это поведение можно поменять при помощи некоторых CSS-свойств. При изменении значений этих свойств элемент перестаёт взаимодействовать с остальными блоками в потоке. Говорят, что он «вышел из потока».</p>
<p>Тут нужно отметить, что элементы, вышедшие из потока, создают внутри себя своего рода мини-поток. Их дочерние элементы будут подчиняться правилам взаимодействия в потоке в пределах родителя.</p>
<h3>Обтекание при помощи <a href="/css/float/"><code>float</code></a></h3>
<p>Когда мы делаем элемент плавающим, он перестаёт взаимодействовать с другими элементами блочного контекста. При этом со строчным контекстом наш плавающий блок продолжает взаимодействовать. Текстовые элементы обтекают такой блок с одной из сторон.</p>
<iframe title="Обтекание при помощи float" src="demos/float/" height="640"></iframe>
<h3>Позиционирование элемента при помощи <a href="/css/position/"><code>position</code></a></h3>
<p>Если задать элементу абсолютное или фиксированное позиционирование, это также приводит к выходу из потока. Но только в этом случае наш элемент не участвует даже в строчном контексте.</p>
<iframe title="Позиционирование элемента при помощи position" src="demos/absolute/" height="460"></iframe>
<p>При абсолютном или фиксированном позиционировании элемент как бы поднимается над содержимым страницы, и становится «не виден» всем остальным блокам.</p>
