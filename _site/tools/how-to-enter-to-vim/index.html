<h2>Кратко</h2>
<p><a href="https://www.vim.org/">Vim</a> — сложный, но очень интересный инструмент. Он позволяет сильно ускорить вашу работу с текстом. В этой статье познакомимся с общими принципами работы в Vim, изучим режимы работы, посмотрим на некоторые команды и их поведение.</p>
<p>Горячие клавиши есть в любом IDE, но Vim можно использовать в любом редакторе, что снимает с вас необходимость изучения шорткатов.</p>
<h2>Как войти</h2>
<p><img src="images/wq.jpg" alt="Кадр из фильма «Прибытие». Девушка показывает пришельцам табличку с надписью «Esq :q»"></p>
<p>Все мы с вами сталкиваемся с Vim: при создании коммита или при работе на удалённом сервере. Однако, мало кто задумывался почему этот инструмент настолько популярен. Его поклонники до сих пор существуют и продвигают Vim в массы.</p>
<h2>Общая концепция</h2>
<p>Основная идея Vim заключается в том, что редактирование текста (в нашем случае кода) более сложная задача чем его создание. С нуля писать просто — сосредоточился и тыкаешь правильные кнопочки в правильной последовательности. А для редактирования нужно понять, куда вносить правки, навести мышь на эту часть кода, начать удалять буквы удерживая Backspace, и только после этого можно будет вводить другой код. Повторить до успешного результата.</p>
<p>Однако перемещение и редактирование может происходить гораздо быстрее в случае, если не придётся трогать мышь или тачпад. Подумал и бац, уже редактируешь код в правильном месте. Магия вне Хогвартса — не иначе.</p>
<h2>Принцип команд</h2>
<p>Большинство команд при работе в Vim это обычные глаголы и существительные в английском языке.</p>
<ul>
<li>Удалить слово: delete word — <kbd>dw</kbd>.</li>
<li>Заменить два слова: change 2 word — <kbd>c2w</kbd>.</li>
<li>Ввести текст: insert — <kbd>i</kbd>.</li>
<li>Удалить всё в скобках: delete inside ( — <kbd>di(</kbd>.</li>
</ul>
<p>Иногда важно расположение курсора для той или иной команды. Например, если курсор находится в середине слова, то <kbd>dw</kbd> отработает не совсем ожидаемо: удалится часть слова после курсора <em>включая букву под курсором</em>. Чтобы достичь желаемого поведения, достаточно вспомнить, что мы находимся в середине слова и поэтому нам понадобиться команда <kbd>diw</kbd>.</p>
<video controls width="700">
  <source src="video/diw-di.mp4" type="video/mp4">
</video>
<h2>Клавиши hjkl</h2>
<p>Клавиши <kbd>h</kbd><kbd>j</kbd><kbd>k</kbd><kbd>l</kbd> — это основные команды для движения по открытому файлу в визуальном режиме (подробнее о режимах Vim поговорим ниже). Использование именно этих клавиш это историческая особенность. Когда <!-- yaspeller ignore:start --><a href="https://ru.wikipedia.org/wiki/%D0%94%D0%B6%D0%BE%D0%B9,_%D0%91%D0%B8%D0%BB%D0%BB">Билл Джой</a><!-- yaspeller ignore:end --> создавал редактор vi, стрелочки на его машине <a href="https://ru.wikipedia.org/wiki/ADM-3">ADM-3</a> были именно на этих кнопках.</p>
<ul>
<li>h — ←</li>
<li>j — ↓</li>
<li>k — ↑</li>
<li>l — →</li>
</ul>
<p><img src="images/hjkl-keyboard.svg" alt="Схема клавиатуры со стрелками, нанесёнными на клавиши h, j, k, l"></p>
<h2>Режимы</h2>
<p>Существует 5 основных режимов для работы в Vim. Большая часть из них создана для редактирования текста тем или иным способом.</p>
<ol>
<li>Режим <em>normal</em> — позволяет перемещаться по файлу используя кнопки, которые мы изучили ранее.</li>
<li><kbd>i</kbd> — <em>insert</em>, режим ввода текста.</li>
<li><kbd>v</kbd> — <em>visual</em>, режим выделения текста.</li>
<li><kbd>:</kbd> — <em>command</em>, режим ввода команд bash.</li>
<li><kbd>R</kbd> — <em>replace</em>, режим замены текста <strong>перед</strong> курсором.</li>
</ol>
<p><kbd>Esc</kbd> — выйти из любого режима и вернуться в нормальный режим.</p>
<video controls width="700">
  <source src="video/rewrite.mp4" type="video/mp4">
</video>
<h2>Undo-Redo</h2>
<p>Все мы совершаем ошибки и хотим их изменить. В Vim это возможно одним движением.</p>
<p>Для отмены последнего редактирования используется кнопка <kbd>u</kbd> (undo). Для отмены отмены редактирования <kbd>Ctrl r</kbd> (redo).</p>
<h2>Как же выйти из Vim?</h2>
<p>Как было сказано ранее, все в Vim это глаголы и существительные английского языка. Сохранение и выход не исключение. Эти операции совершаются в режиме команд. Войти в этот режим можно через кнопку <kbd>:</kbd>.</p>
<ul>
<li><kbd>w</kbd> — write, сохранить;</li>
<li><kbd>q</kbd> — quit, выйти;</li>
<li><kbd>q!</kbd> — выйти без сохранения изменений;</li>
<li><kbd>wq</kbd> — выйти и сохранить.</li>
</ul>
<h2>Навигация по тексту</h2>
<p>Передвигаться по тексту в Vim можно очень быстро. За пару комбинаций можно перепрыгнуть на место в коде о котором вы подумали и тут же начать его редактировать. Все комбинации работают в режимах <em>normal</em> и <em>visual</em>.</p>
<h3>Прыгаем по словам</h3>
<p>Если слово <strong>не</strong> содержит пунктуационный знак в конце:</p>
<ul>
<li>переместить курсор <em>вперёд</em> на начало следующего слова — <kbd>w</kbd>;</li>
<li>переместить курсор <em>вперёд</em> на конец слова — <kbd>e</kbd>;</li>
<li>переместить курсор <em>назад</em> на начало слова — <kbd>b</kbd>.</li>
</ul>
<p>Если слово содержит пунктуационный знак в конце:</p>
<ul>
<li>курсор <em>вперёд</em> на начало следующего слова — <kbd>W</kbd>;</li>
<li>курсор <em>вперёд</em> на конец слова — <kbd>E</kbd>;</li>
<li>курсор <em>назад</em> на начало слова — <kbd>B</kbd>.</li>
</ul>
<h3>Начало и конец строки</h3>
<ul>
<li>в <em>начало</em> строки — <kbd>0</kbd>;</li>
<li>в <em>начало</em> строки на первый <strong>не</strong> пробельный символ — <kbd>^</kbd>;</li>
<li>в <em>конец</em> строки — <kbd>$</kbd>.</li>
</ul>
<h3>Начало и конец файла</h3>
<ul>
<li>в самое начало файла — <kbd>gg</kbd>;</li>
<li>в конец файла — <kbd>G</kbd>.</li>
</ul>
<h3>Перейти на конкретную строку</h3>
<ul>
<li>перейти на строку 32 — <kbd>:32</kbd>.</li>
</ul>
<h3>Поиск по слову</h3>
<ul>
<li>найти слово param — <kbd>/param</kbd>.</li>
</ul>
<p>Если совпадений несколько, то переход к следующему совпадению — <kbd>n</kbd> (next), к предыдущему — <kbd>N</kbd>.</p>
<h3>Перемещение по файлу</h3>
<ul>
<li><em>вверх</em> на половину экрана — <kbd>Ctrl u</kbd>;</li>
<li><em>вверх</em> на <em>весь</em> экран — <kbd>Ctrl b</kbd>;</li>
<li><em>вниз</em> на половину экрана — <kbd>Ctrl d</kbd>;</li>
<li><em>вниз</em> на <em>весь</em> экран — <kbd>Ctrl f</kbd>.</li>
</ul>
<p>По моему мнению использование этих клавиш для быстрого перемещения по странице не очень удобно — становится сложно следить за текстом из-за скорости. Vim слишком быстрый и мозг не успевает отследить столь быстрое перемещение. Есть вариант лучше:</p>
<ul>
<li><em>вверх</em> к следующей пустой строке — <kbd>{</kbd></li>
<li><em>вниз</em> к следующей пустой строке — <kbd>}</kbd></li>
<li>вернутся к прошлому месту курсора — <kbd>Ctrl o</kbd></li>
<li>обратное команде выше, к прошлому месту курсора — <kbd>Ctrl i</kbd></li>
</ul>
<h2>Заключение</h2>
<p>Vim не устарел, инструмент по-прежнему остаётся очень мощным. Дело не только в быстром редактировании или моментальному передвижении по файлу, но и в том, что Vim довольно просто превратить из редактора в полноценную IDE, заточенную конкретно под ваши нужды.</p>
