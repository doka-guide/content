---
title: "`color-mix()`"
description: "Функция смешивает два цвета для получения оттенков, состояний и тем."
baseline:
  - group: color-mix
    features:
      - css.types.color.color-mix
authors:
  - teplostanski
tags:
  - doka
---

## Кратко

Функция `color-mix()` смешивает два цвета в выбранном цветовом пространстве и возвращает один результирующий цвет. Это удобно для получения светлых и тёмных вариаций цветов, создания оттенков для состояний наведения, активности, отключения элементов и согласованных тем без препроцессоров. По умолчанию смешивание происходит в пространстве `oklab`.

## Пример

Сформируем светлую и тёмную версии брендового цвета для разных состояний кнопки:

```css
:root {
  --brand: #2E9AFF;
}

.button {
  background: var(--brand);
  color: white;
}

.button:hover {
  /* светлее: добавляем белый */
  background: color-mix(in oklab, var(--brand) 80%, white);
}

.button:active {
  /* темнее: добавляем чёрный */
  background: color-mix(in oklab, var(--brand) 70%, black);
}
```

## Как пишется

```
color-mix(in <цветовое-пространство> [<метод-интерполяции-оттенка>]?, <цвет> <процент>?, <цвет> <процент>?)
```

Важно знать:

- Ключевое слово `in` с указанием цветового пространства обязательно.
- Функция принимает ровно два цвета.
- Проценты можно указать у одного или обоих цветов. Если указан один — второй берётся как остаток до 100%. Если не указаны оба — будет 50%/50%.
- Если сумма процентов не равна 100% (в том числе больше 100%), они нормализуются к 100%. Отрицательные проценты недопустимы.
- Проценты можно вычислять через [`calc()`](/css/calc/), итоговое значение должно быть процентом.
- Допустимы абсолютные цвета: [`hex`](/css/web-colors/#hex), [`rgb`/`rgba`](/css/web-colors/#rgb), [`hsl`/`hsla`](/css/web-colors/#hsl), [`hwb`](/css/web-colors/#hwb), `lab`, `lch`, `oklab`, `oklch`, `color(display-p3 …)`, `color(rec2020 …)`, `color(a98-rgb …)`, `color(prophoto-rgb …)`, `xyz`/`xyz-d50`/`xyz-d65` и другие, поддерживаемые браузером.
- Нельзя использовать «относительные» значения: [`currentColor`](/css/currentcolor/), системные цвета, [`light-dark()`](/css/light-dark/), `contrast-color()`, `device-cmyk()`. Такие аргументы внутри `color-mix()` недопустимы.
- Альфа-канал учитывается: смешивание выполняется с учётом прозрачности, затем результат нормализуется.
- Для цилиндрических пространств ([`hsl`](/css/web-colors/#hsl), [`hwb`](/css/web-colors/#hwb), `lch`, `oklch`) можно задать метод интерполяции оттенка:
  - `shorter` | `longer` | `increasing` | `decreasing` | `specified`
  - По умолчанию — `shorter` (короткий путь по кругу).

Примеры:

```css
/* 50/50 по умолчанию в oklab */
color-mix(in oklab, red, white);

/* Явные веса в lch */
color-mix(in lch, hsl(340 90% 55%) 70%, black 30%);

/* Линейное sRGB — ближе к «физическому» смешению света */
color-mix(in srgb-linear, #F00 40%, #00F 60%);

/* Управление маршрутом оттенка в oklch */
color-mix(in oklch shorter hue, oklch(60% 0.2 350) 50%, oklch(60% 0.2 10) 50%);
```

## Как понять

Цветовое пространство кардинально влияет на результат. Одни и те же два цвета дадут разные смеси в `sRGB`, `LCH` и `oklab`.

### Выбор цветового пространства

- **oklab/oklch** — для гладких, перцептуально ровных переходов. Универсальный выбор для большинства задач.
- **hsl/hwb** — дают более яркие, иногда смещённые по оттенку смеси. Подходят для эффектов и акцентов.
- **srgb-linear** — полезен, когда нужен результат, близкий к линейной модели света (например, плавные градации от чёрного к белому).
- **display-p3/rec2020** — широкие гаммы могут дать более насыщенные результаты на совместимых дисплеях, но требуют фолбэка.

### Создание цветовой шкалы

Шкала оттенков из одного базового цвета:

```css
:root {
  --brand: #2E9AFF;

  /* Светлые варианты */
  --brand-95: color-mix(in oklab, var(--brand) 5%, white);
  --brand-90: color-mix(in oklab, var(--brand) 10%, white);
  --brand-80: color-mix(in oklab, var(--brand) 20%, white);
  --brand-60: color-mix(in oklab, var(--brand) 40%, white);
  --brand-40: color-mix(in oklab, var(--brand) 60%, white);
  --brand-20: color-mix(in oklab, var(--brand) 80%, white);

  /* Тёмные варианты */
  --brand-dark-80: color-mix(in oklab, var(--brand) 80%, black);
  --brand-dark-60: color-mix(in oklab, var(--brand) 60%, black);
}
```

### Работа с широкими гаммами

Тема с широкой гаммой и фолбэком:

```css
.card {
  /* Фолбэк для sRGB */
  background: color-mix(in oklab, #2E9AFF 85%, white);

  /* Если есть поддержка P3, используем широкую гамму */
  background: color-mix(in oklab, color(display-p3 0.1 0.5 1) 85%, white);
}
```

### Работа с прозрачностью

```css
.badge {
  --bg: color-mix(in oklab, #2E9AFF 70%, white);
  background: var(--bg);
  color: white;
}

.badge--muted {
  /* Подмешиваем прозрачный цвет — результат тоже будет полупрозрачным */
  background: color-mix(in oklab, var(--bg) 60%, rgba(0, 0, 0, 0) 40%);
}
```

## Подсказки

### Проверка поддержки

Обязательно предусматривайте фолбэк, так как поддержка браузерами пока ограничена:

```css
.element {
  background: #2E9AFF; /* фолбэк */
}

@supports (color: color-mix(in oklab, black, white)) {
  .element {
    background: color-mix(in oklab, #2E9AFF 85%, white);
  }
}
```

### Частые ошибки

- Если аргументы `color-mix()` невалидны (неподдерживаемое пространство, относительные цвета, отрицательные проценты), всё значение свойства признаётся невалидным. Поэтому всегда указывайте фолбэк-цвет перед `color-mix()`.
- Помните о нормализации процентов: сумма больше 100% допустима, но будет пересчитана. Отрицательные значения — ошибка.
- При смешении в широких гаммах (например, `display-p3`) на sRGB-устройствах цвета будут сжаты в доступный охват. В критичных местах сравнивайте визуально и обеспечивайте sRGB-альтернативы.
