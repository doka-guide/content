---
title: "IPv6 для Web-разработчиков"
description: "Протокол IPv6, с разбором ситуаций для Web-разработчиков"
authors:
  - disi
keywords:
  - ipv6
  - прикладной уровень
related:
  - tools/network
  - tools/tcp-udp-protocols
  - tools/network-models
tags:
  - article
---

## Кратко

IPv6 или Internet Protocol version 6 — сетевой протокол, который обеспечивает передачу данных между компьютерами и другими устройствами в интернете. 

Основная идея заключается в том же, в чем и идея нашего интернета — прямой связности и построению одноранговой сети. В сравнении с IPv4 (актуальной, но устаревающий версией), было исправлено множество багов и добавлены удобные решения.

Основные преимущества в веб:
 - Прямые соединения, это преимущество для VoIP и WebRTC, не нужно обходить NAT
 - Меньше проблем с блокировками. У каждого устройства свой уникальный IP-адрес. Шанс, что вас заблокируют из-за соседа на хостинге, практически равен нулю.
 - При входе на сайт снижается вероятность столкнуться с капчей на анти-DDoS сервисах.
 - Косвенные SEO преимущества, например, Google может учитывать доступность сайта по IPv6 или [политики Apple](https://developer.apple.com/support/ipv6/)
 - Актуальность в развивающихся странах. Во многих регионах провайдеры используют только IPv6. Если вы делаете международный продукт — это важно.


## Как понять

IPv6-адрес состоит из 128 бит, которые записываются в виде восьми групп по 4 шестнадцатеричных символа (хекстета).

Возьмем, к примеру, адрес `2001:0db8:4ac7:fddd:8da3:981f:fbda:1e43`, выглядит страшно, но на деле всё очень просто, адрес можно поделить на две части:
 - `2001:0db8:4ac7:fddd` глобальный префикс который определяется провайдером
 - `8da3:981f:fbda:1e43` уникальный идентификатор устройства в сети

В отличии от IPv4 вы можете представить вторую половину как UUID устройства.


## Как на деле

IPv6 позволяет сокращать адреса для удобного вида

 - Заменим нули на `::`, но можно только один раз в адресе:
   `2001:0DB8:0000:0000:0000:0000:0000:0000` → `2001:0DB8::`
 - Внутри каждого хекстета можно убрать первые нули тоже:
   `2001:0DB8::` → `2001:DB8::`
 - Если хочется сохранить наглядность, можно оставлять по одному нулю:
   `2001:DB8:0:0:0:0:0:0`

Обычный адрес вы видели выше, но самые короткие адреса которые можно встретить, например:
 - `::1` - петля, аналог `127.0.0.1`
 - Случайный адрес из интернета `2600::`, да вы можете запустить команду `ping 2600::` и получите ответ.

## Как указывать IPv6?
Поскольку символ `:` используется в адресе, его нужно экранировать квадратными скобками в строках URL:

```
https://[2001:0db8:4ac7:fddd:8da3:981f:fbda:1e43]:8080 
```

В некоторых командах, например, в `telnet`, скобки не нужны:

```bash
telnet 2001:0db8:4ac7:fddd:8da3:981f:fbda:1e43 8080
```

## Некоторые префиксы и маски
В IPv6 вместо масок подсети используются префиксы, обозначаются как `/число`.
Небольшой список: 

| ПРЕФИКС  | РАЗМЕР | НАЗНАЧЕНИЕ |
|-------|-----|------|
| /64 | 1 /64 подсеть | Базовая подсеть, аналог /24 в IPv4 на ваших домашних роутерах |
| /60 | 16 подсетей /64 | Выдается интернет провайдером |
| /56 | 256 подсетей /64 | Выдается интернет провайдером |
| /48 | 65 536 подсетей /64 | Выдается интернет провайдером на организацию или предприятие |
| /32 | 65 536 подсетей /48 | Такие подсети имеют сами интернет провайдеры |

Пример: `2001:0db8:4ac7:fddd::/64`

Подробные расчеты можно сделать в [специальном калькуляторе](https://www.vultr.com/resources/subnet-calculator-ipv6/)

## Известные зарезервированные подсети
| ПРЕФИКС  | НАЗНАЧЕНИЕ |
|-------|-----|
| ::1/128 | Петля  | 
| 2001:0DB8::/32 и 3FFF::/20   |  Подсети созданные для документов, подразумевается, что люди видя эти адреса будут вставлять свои или это абстрактный пример.  | 
| FE80::/10 |  [Link-local](https://ru.wikipedia.org/wiki/Link-local_address)  | 
| ::FFFF:0:0/96 | Для конвертации из IPv4 в IPv6, можно часто встретить в СУБД |

Остальные можно посмотреть на [википедии](https://en.wikipedia.org/wiki/Reserved_IP_addresses#IPv6)

## Приватность и маркетинг
Следуя из логики, что каждое устройство имеет свой индивидуальный адрес, можно подумать, что сервис может вычислить человека с детальной точностью и собирать всю информацию, например, для выдачи рекламы, но это не так. Все современные операционные системы имеют временные IP адреса, что позволяет менять адрес, с которого устройство выходит в интернет. Поэтому при работе с адресами следует работать с маской /64 и шире. 

## Необходимость
Кажется, что IPv6 нигде не используется, но на самом деле это не так, если вы делаете приложение или веб сайт конкретно для смартфонов, то вы можете получать до 80% IPv6 трафика, в сравнении с IPv4.

## Как сделать у себя
Чтобы ваш сайт работал с IPv6 нужно:

 - Убедиться что у вас имеется IP адрес из подсети 2000::/3 на сервере, 
 - Ваш веб-сервер настроен на работу с IPv6
 - Сделать IP адрес сервера статичным
 - Прописать в DNS соответствующую АААА-запись на ваш IPv6 адрес

К сожалению, Дока не использует IPv6, но это не значит, что вам не нужно. Просто начните, и вероятно, вы сделаете что-то полезное для интернет провайдеров и для самих посетителей.


