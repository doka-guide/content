## Мониторинг пакетов

Существуют специальные утилиты, которые позволяют просматривать пакеты в сетевом трафике, что позволяет разобраться с работой того или иного сетевого устройства. В Linux и большинстве Unix-подобных систем есть консольная утилита _tcpdump_, есть и кросс-платформенная утилита Wireshark с графическим интерфейсом. Эти две утилиты в основном и используются для мониторинга пакетов.

### Wireshark

Утилиту Wireshark можно [скачать](https://www.wireshark.org/#download) и установить с официального сайта. Она опенсорсная и имеет графический интерфейс, который состоит из трёх частей (сверху вниз):

- список пакетов, пересылаемых по сети;
- пакет, представленный в текстовом виде;
- пакет, представленный в бинарном виде.

![Рабочее окно утилиты Wireshark](images/1.png)

Вы можете получить подробную информацию о каждом пакете, нужно лишь выбрать его из списка. Пакеты можно фильтровать по различным признакам. Существуют фильтры захвата и показа. Первый тип фильтров используется для захвата пакетов в реальном времени, сбора информации и статистики по ним. Фильтры показа (дисплейные фильтры) позволяют оперировать с уже захваченными пакетами. Захват пакетов с выбранного сетевого интерфейса осуществляется с момента нажатия кнопки «Начать захват пакетов» (Start capturing packets) и до нажатия кнопки «Остановить захват пакетов» (Stop capturing packets). Захват пакетов — это сбор информации о пакетах.

В Wireshark есть предустановленные фильтры, но можно формировать и собственные с помощью мастера или вручную в строке фильтрации в самом верху окна. Утилита Wireshark поможет веб-разработчику детально разобраться с пакетами, которые отправляются серверу или приходят от сервера. Если [веб-сервер](/tools/web-server/) установлен на компьютере с Wireshark, можно посмотреть, как пользователи работают с сайтом.

Мониторинг пакетов также может помочь выявить аномальный трафик и проанализировать безопасность компьютера с точки зрения его работы с сетью. Данные можно сохранять в текстовый файл для последующего анализа в Wireshark или любым другим способом.

### Tcpdump

Если графический интерфейс не доступен, например, вы настраиваете удалённый сервер, можно использовать _tcpdump_. Чтобы просмотреть трафик, надо набрать команду:

```bash
tcpdump
```

Не забывайте, что на некоторых операционных системах, утилиту необходимо запускать от имени администратора.

Пока вы не прервёте работу утилиты сигналом `SIGINT`, нажав сочетание клавиш <kbd>Ctrl C</kbd>, в терминал будет выводиться информация о пакетах. Прочитайте статью [«Управление процессами»](/tools/process-management/), чтобы узнать больше о сигналах. Как работать с терминалом описано в статье «[Интерфейс командной строки](/tools/cli/)».

Пакеты можно фильтровать. Например, чтобы вывести пакеты, которые приходят на 80-й порт по протоколам транспортного уровня TCP или UDP, нужно выполнить команду:

```bash
tcpdump udp port 80 or tcp port 80
```

Информацию можно выводить в файл, а не в терминал. Для этого нужно указать соответствующий ключ:

```bash
tcpdump -w out.pcap
```

Чтобы прочитать этот файл, можно использовать Wireshark, который поддерживает данные в формате PCAP, или тот же _tcpdump_:

```bash
tcpdump -r out.pcap
```
