---
title: "Дерево доступности"
description: ""
authors:
  - tatianafokina
keywords:
  - программа чтения с экрана
  - программа экранного доступа
  - screen reader
  - assistive technology
  - a11y tree
related:
  - a11y/chto-takoe-a11y
  - a11y/aria-intro
  - a11y/wcag
tags:
  - article
---

https://canvas.workday.com/accessibility/the-accessibility-tree/
https://alistapart.com/article/semantics-to-screen-readers/#section5
https://adrianroselli.com/2020/12/be-careful-with-dynamic-accessible-names.html
https://developer.chrome.com/blog/full-accessibility-tree/
https://web.dev/articles/the-accessibility-tree
https://hidde.blog/how-accessibility-trees-inform-assistive-tech/#heading-3

_Дерево доступности_ или _доступное дерево (accessibility tree)_ — это представление элементов документа в виде дерева на основе [DOM](/js/dom/) (Document Object Model) и некоторых CSS стилей. Это одна из частей DOM, которая доступна для вспомогательных технологий.

Благодаря ему вспомогательные технологии, например, скринридеры, знают, что содержит страница сайта и что на ней происходит. Конечно, такие технологии взаимодействуют с деревьями не напрямую, а через посредника, Accessibility API, но это уже совсем другая история. Деревья передают технологиям самую важную информацию о странице, благодаря которой пользователи её могут воспринимать, управлять ей, понимать её и прочее.

Так что, если на странице есть важная информация или функциональность, но вы на уровне кода не смогли её передать в дерево доступности, у пользователей нет возможности взять её откуда-то ещё.

## Как выстраивается

В дерево попадает информация на основе того, как свёрстана страница. То есть на него влияет больше всего HTML, чуть меньше CSS и JavaScript.

Дерево доступности не полностью копирует DOM-дерево. Например, в него не попадают скрытые элементы с `display: none`, `visibility: hidden`, [атрибутом `hidden`](/html/hidden/) или декоративные [`<div>`](/html/div/).

За деревья ответственны браузеры. Именно они строят отдельные деревья для каждой страницы и передают их операционным системам для дальнейшего взаимодействия с ними вспомогательными технологиями. Так как вендоры разные, реализация деревьев тоже отличается. Названия ролей могут быть разными, по разному вычислять имена и определяться встроенные в теги роли и состояния и так далее.

An a11y tree is created simultaneously with the DOM. Browsers trigger the a11y tree to give assistive technologies something to hook into. When we use ARIA attributes, we give auxiliary instructions to the browser about how to render an a11y tree.

## Как устроено

Похоже на [DOM-дерево](/js/dom/#iz-chego-sostoit-dom), только состоит не из HTML-элементов, а из _доступных объектов (accessible object)_. Каждый объект содержить самую важную информацию об элементе, которую нужно передать вспомогательным технологиям.

 Each node in the accessibility tree represents an element in the UI as exposed through the accessibility API. Accessible objects for HTML elements are created when at least one of the triggers is present:

it may fire an accessibility event;
it has a property, relationship, or feature which needs to be exposed to assistive technology.

Именно поэтому важна семантика. У семантических тегов вся основная информация доступна из коробки, её часто не нужно мучительно руками.

Какая информация об элементе важна для дерева доступности и, соответсвенно, есть у объектов в нём?

- Роль (role).
- Имя (name), если есть.
- Описание (description) и/или вспомогательный текст (helper text), если есть.
- Свойства, состояния и методы.

Роли, имена и поведение элементов можно явно задавать и изменять с помощью _[ARIA-разметки](/a11y/aria-intro/) (Accessible Rich Internet Applications)_. Это вспомогательная техника для создания более доступного контента для скринридеров. Расширяет возможности HTML с помощью специальных атрибутов и ролей.

Одно из главных правил её использования — стараться не использовать ARIA. Так что она пригодится, когда не хватает возможностей HTML. К примеру, для сложных интерактивных элементов — вкладок, выпадающих списков, модальных окон или оповещений об ошибках. В этом случает [ARIA-атрибуты](/a11y/aria-attrs/) и JavaScript сделают поведение контрола понятным и предсказуемым.

Additionally, the accessibility tree often contains information on what can be done with an element: a link can be followed, a text input can be typed into, that kind of thing.

### Роль

- Роль (role). Она соответствует типу элемента. Например, есть роли `button`, `link` или `banner`.

Во многие [семантические теги](/html/#semantika) роли уже встроены. Роль [`<a>`](/html/a/) — [`link`](/a11y/role-link/), [`<header>`](/html/header/) — [`banner`](/a11y/role-banner/), [`<ul>`](/html/ul/) — [`list`](/a11y/role-list/). Полный список можно найти на [странице с HTML-элементами и именами](https://russmaxdesign.github.io/html-elements-names/). Поэтому для доступности важна семантическая вёрстка. Если вместо [`<button>`](/html/button/) использовать `<div>` с событием `onclick`, то у него не будет роли кнопки и её поведения. Пользователи скринридеров не узнают, что элемент кликабельный.

### Имя

Его также называют доступным именем (accessible name). Помогает лучше понять, что это за объект и его цель. Обычно озвучивается при фокусе. Оно берётся из текстового содержимого тегов или атрибутов.

Это подпись к элементу. Мы привыкли к тому, что только у полей может быть подпись, но, на самом деле, она есть у всех элементов, просто не из-за тега `<label>`.

К примеру, имя элемента `<button>Зарегистрироваться</button>` — «Зарегистрироваться».

Как вычисляется. Спека. https://www.w3.org/TR/accname-1.1/

### Всё вместе

Тут схема?

### Описание

- Описание (description) и/или вспомогательный текст (helper text), если есть. Дополнение к имени. Озвучивается, если выбрана такая настройка в скринридере.

### Свойства, состояния и методы

- Свойства и методы. Содержат детали о раскладке (layout) и возможных действиях. К примеру, можно ли изменить значение элемента или как-то иначе с ним взаимодействовать.

## Как взаимодействуют браузеры, скринридеры и Accessibility API

Представим, что пользователь скринридера добрался до кнопки «Отправить»:

1. Сначала скринридер запрашивает информацию о кнопке.
1. Accessibility API получает запрос и передаёт его браузеру.
1. Браузер проверяет DOM и находит нужный элемент и его стили.
1. Теперь браузер может преобразовать элемент из DOM в понятный формат для Accessibility API. Это и есть объект из дерева доступности с именем и ролью. После этого браузер отдаёт его API.
1. API возвращает эту информацию скринридеру.
1. Скринридер объявляет: «Отправить, кнопка». Ура!

![Схема чтения кнопки скринридером. Программа запрашивает элемент у Accessibility API, он передаёт его браузеру, браузер находит кнопку в документе, отдаёт API имя «Отправить» и роль «button», скринридер получает от API имя и роль элемента и зачитывает их.](images/3.png)

Теперь пользователь решил нажать на кнопку, чтобы что-то отправить:

1. Скринридер вызывает метод из Accessibility API.
1. Accessibility API идёт к браузеру и сообщает о вызове метода.
1. Браузер ищет и обрабатывает событие с учётом того, есть ли обработчик события.
1. Представим, что на сайте есть скрипт, который отслеживает события. В этом случае он выполняется, и происходит нужное действие при клике на кнопку.

![Схема нажатия на кнопку. Скринридер запрашивает метод у Accessibility API, он передаёт этот метод браузеру, браузер находит скрипт с обработчиком события, в итоге выполняется какая-то функция при клике на кнопку.](images/4.png)

## Как заглянуть

Вы можете посмотреть на дерево доступности в браузерах до взаимодействия с ними вспомогательных технологий.

Chrome. Открыть инструмент разработчика Chrome, под вкладкой Элементы найти другую Доступность. Первый пункт в списке Accessibility Tree.

Firefox. Открыть интсрумент разработчика Firefox, выбрать вкладку Accessibility. Включить опцию accessibility features, после этого появится Accessibility Tree.

Посмотреть на дерево доступности можно в инспекторах браузеров во вкладке с доступностью. Например, так выглядит [`<img>`](/html/img/) в виде объекта дерева в Firefox. У него роль `graphic` (в Chrome будет [`img`](/a11y/role-img-image/)), а имя — это описание картинки из атрибута `alt`.

![Дерево доступности в инструментах разработчика в Firefox для элемента картинки. name: Пример клавиатуры для поля ввода номера телефона. role: graphic. DOMNode: img.](images/2.png)

## Будущее

While still in draft form within the Web Incubator Community Group as of April 2022, the Accessibility Object Model (AOM) intends to incubate APIs that make it easier to express accessibility semantics and potentially allow read access to the computed accessibility tree.

https://wicg.github.io/aom/explainer.html
