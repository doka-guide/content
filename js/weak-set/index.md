---
title: "`WeakSet`"
description: "Коллекция, в которой временно хранятся уникальные объекты."
authors:
  - ra1nbow1
keywords:
  - keyed collection
  - javascript collection
related:
  - js/collection-weakmap
  - js/map
  - js/set
tags:
  - doka
---

## Кратко

`WeakSet` — встроенная коллекция в JavaScript, которая представляет собой набор [объектов](/js/object/), где каждый объект может быть добавлен только один раз. В отличие от обычного [`Set`](/js/set/), `WeakSet` допускает только объекты в качестве элементов. Основное назначение `WeakSet` — временное хранение объектов, которые могут быть удалены из памяти, если на них нет других ссылок. Это делает коллекцию полезной для управления памятью.

Одна из ключевых особенностей `WeakSet` — элементы в этой коллекции слабо связаны. Это означает, что если объект больше не используется в программе (и на него нет других ссылок), он может быть автоматически удалён сборщиком мусора, даже если находится в `WeakSet`.

## Пример

```js
var ws = new WeakSet()
var obj = {}
var foo = {}

// Добавляем глобальный объект window в WeakSet
ws.add(window)

// Добавляем объект obj
ws.add(obj)

console.log(ws.has(window))
// true, window присутствует в WeakSet

console.log(ws.has(foo))
// false, foo не был добавлен

// Удаляем window из WeakSet
ws.delete(window)

console.log(ws.has(window))
// false, window больше нет в WeakSet
```

## Как пишется

`WeakSet` полезна, когда вы временно храните объекты, не удерживая их в памяти дольше, чем это необходимо. Например, если у вас есть система слежения за объектами, которая должна автоматически забывать об объектах, если они больше не используются в коде. В этих случаях `WeakSet` позволяет избежать утечек памяти.

Пример использования `WeakSet` — хранение метаданных о [DOM-элементах](/js/dom/), чтобы не препятствовать их удалению, когда они больше не нужны.

### Особенности

**Только объекты**. `WeakSet` принимает только объекты в качестве элементов. Примитивные значения, такие как строки, числа или [булевы значения](/js/boolean/), нельзя добавить.

**Слабые ссылки**. Элементы `WeakSet` не предотвращают сборку мусора. Если объект, добавленный в `WeakSet`, больше не используется в коде и на него нет сильных ссылок, он будет автоматически удалён.

**Нет итерирования**. В `WeakSet` нет методов для перебора элементов, например, [`forEach`](/js/set-foreach/). Причина — это потенциально препятствует сборщику мусора удалять объекты. В результате `WeakSet` является непрозрачной коллекцией: вы не можете узнать, какие объекты хранятся в ней. Единственный способ проверить наличие конкретного объекта — метод [`has()`](/js/set-has/).

**Уникальность объектов**. Можете добавить объект в `WeakSet` только один раз.

### Методы

`add(value)` добавляет объект в коллекцию `WeakSet`. Возвращает экземпляр `WeakSet`, что позволяет использовать методы цепочкой.

Параметр `value` у [`add()`](/js/set-add/) — объект, который добавится в `WeakSet`.

Пример с `add()`:

```js
var ws = new WeakSet()
var obj = {}
ws.add(obj)
```

`has(value)` проверяет присутствие объекта в `WeakSet`. Возвращает булево значение `true`, если объект присутствует, и `false` в противном случае.

У `has()` может быть параметр `value`. Это объект, наличие которого нужно проверить.

Пример с `has()`:

```js
ws.has(obj)
// true
```

`delete(value)` удаляет объект из `WeakSet`, если он присутствует. Возвращает булево значение `true`, если объект удалён, и `false`, если объект не найден в коллекции.

Параметр [`delete()`](/js/set-delete/) — `value`. Это объект, который удаляем.

Пример использования `delete()`:

```js
ws.delete(obj)
ws.has(obj)
// false
```

### Ограничения

- `WeakSet` поддерживает только объекты, [примитивы](/js/#primitivnye-tipy-dannyh) (строки, числа, булевы значения) добавить нельзя.
- Невозможно узнать, сколько объектов хранится в `WeakSet`, так как сборщик мусора может автоматически их удалить.
- `WeakSet` не даёт итерироваться (перемещаться) по элементам коллекции.

### Отличия от `Set`

`Set` и `WeakSet` отличаются друг от друга. Во-первых, в `WeakSet` хранятся только объекты. В `Set` можете хранить любые типы данных.

Второе отличие — элементы `WeakSet` слабо связаны, что позволяет сборщику мусора удалять их, когда они больше не нужны. В `Set` этого не происходит.

Последнее отличие — в `WeakSet` нельзя перебирать элементы или узнать их количество. В `Set` для этого доступны разные методы. Например, `size`, итерирование через `forEach()` и другие.
